!function i(o,l,s){function c(t,e){if(!l[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var a=l[t]={exports:{}};o[t][0].call(a.exports,function(e){return c(o[t][1][e]||e)},a,a.exports,i,o,l,s)}return l[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){"use strict";var r,P=(r=e("deepmerge"))&&r.__esModule?r:{default:r};function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}window.FileUploader=function(t,e){var S=this,F=this;this._defaults={lang:"en",useFileIcons:!0,debug:!1,debugLogStyle:"color: #9900ff",name:void 0,pluginName:"FileUploader",useLoadingBars:!0,loadingBarsClasses:[],reloadedFilesClass:"reloadedElement",resultContainerClass:"result",resultFileContainerClass:"uploadedFile",resultPrefix:"fileUploader",resultInputNames:["title","extension","value","size"],defaultFileExt:"",defaultMimeType:"",maxFileSize:50,maxTotalSize:1e3,maxNumberOfFiles:!1,reloadArray:[],reloadHTML:void 0,linkButtonContent:"L",deleteButtonContent:"X",showErrorOnLoadBar:!0,allowDuplicates:!1,duplicatesWarning:!1,labelsContainers:!1,useSourceFileSize:!1,mimeTypesToOpen:["application/pdf","image/png","image/jpeg"],labelsClasses:{sizeAvailable:"sizeAvailable",currentSize:"currentSize",currentNumberOfFiles:"currentNumberOfFiles",maxFileSize:"maxFileSize",maxTotalSize:"maxTotalSize",maxNumberOfFiles:"maxNumberOfFiles",numberOfUploadedFiles:"numberOfUploadedFiles",numberOfRejectedFiles:"numberOfRejectedFiles"},HTMLTemplate:function(){return'<p class="introMsg"></p>\n                    <div>\n                        <div class="inputContainer">\n                            <input class="fileLoader" type="file" multiple />\n                        </div>\n                        <div class="dropZone"></div>\n                        <div class="filesContainer filesContainerEmpty">\n                            <div class="innerFileThumbs"></div>\n                            <div style="clear:both;"></div>\n                        </div>\n                    </div>\n                    <div class="result"></div>'},onload:function(){},onfileloadStart:function(){},onfileloadEnd:function(){},onfileRejected:function(){},onfileDelete:function(){},filenameTest:function(){},langs:{en:{intro_msg:"(Add attachments...)",dropZone_msg:"Drop your files here",maxSizeExceeded_msg:"File too large",maxTotalSizeExceeded_msg:"Total size exceeded",maxNumberOfFilesExceeded_msg:"Number of files allowed exceeded",duplicated_msg:"File duplicated (skipped)"}}};var T=function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=c["".concat(e,"Labels")][Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value.querySelector(":scope > span"),s=void 0;switch(t){case"++":s=parseInt(l.innerHTML)+1,l.innerHTML=s;break;case"--":s=parseInt(l.innerHTML)-1,l.innerHTML=s;break;default:l.innerHTML=t}}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}},L=function(e,t,n){var r=e.substring(5,e.indexOf(";")),a=t.querySelector(".fileSee");0<=S._options.mimeTypesToOpen.indexOf(r)?a.addEventListener("click",function(){window.open().document.write('<iframe src="'.concat(e,'" frameborder="0" style="border:0; top:0px; display:block; left:0px; bottom:0px; right:0px; width:100%; min-height: 100vh; height:100%;" allowfullscreen></iframe>'))}):(a.setAttribute("href",e),a.setAttribute("download",n))};this._options=(0,P.default)(this._defaults,e,{arrayMerge:function(e,t,n){return t}}),this._round=function(e){return Math.round(100*e)/100},this.get=function(e){switch(e){case"currentTotalSize":return S._round(C);case"currentAvailableSize":return S._round(S._options.maxTotalSize-C);case"currentNumberOfFiles":return N;case"availableNumberOfFiles":return S._options.maxNumberOfFiles-N}},this._logger=function(e,t,n){if(S._options.debug){if(t)for(var r=0;r<t;r++)e="âž¡ "+e;S._options.name&&(e="["+S._options.pluginName+" - "+S._options.name+"] "+e),n?console.log("%c "+e,S._options.debugLogStyle,n):console.log("%c "+e,S._options.debugLogStyle)}},this._fileType=function(e){var t=e.substring(e.lastIndexOf(".")+1,e.length);return 0<=["pdf","jpg","png"].indexOf(t)?t:"unknown-file"},this._fileDelete=function(e,t){var n=t.element,r=e.target.dataset.delete;r||(r=e.target.closest("div[data-delete]").dataset.delete),S._options.useFileIcons&&function(e,t){var n=e.previousElementSibling;if(!t)return n;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}(n,"img").remove(),n.remove();var a=M.querySelector('input[name="'.concat(S._options.resultPrefix,"[").concat(r,"][").concat(S._options.resultInputNames[3],']"]')).value;a=S._round(a),C=S._round(C-a),N--;var i=S._options.maxTotalSize-C;i=S._round(i),T("sizeAvailable",i),T("currentSize",C),T("currentNumberOfFiles",N),T("numberOfUploadedFiles","--"),M.querySelector(':scope > div[data-index="'.concat(r,'"]')).remove(),0===document.querySelector(".innerFileThumbs").children.length&&document.querySelector(".filesContainer").classList.add("filesContainerEmpty"),S._logger("Deleted file N: "+r,2),S._options.onfileDelete(r,C,N)},this._fileRename=function(e){var t=e.data.element,n=e.target,r=t.querySelector(":scope > .fileExt").innerHTML,a=n.value,i=t.dataset.index,o=M.querySelector('div[data-index="'.concat(i,'"] input')),l=S._options.filenameTest(a,r,z);if(!1===l)return e.preventDefault(),!1;void 0!==l&&!0!==l&&(a=l,n.value=a,o.value=a,n.setSelectionRange(e.data.start,e.data.stop))},this.getData=function(){var e=[];S._logger("RECEIVED SAVE COMMAND:",0);var t=!0,n=!1,r=void 0;try{for(var a,i=M.querySelectorAll(":scope > .".concat(S._options.resultFileContainerClass))[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value.querySelectorAll(":scope > input"),l={title:o[0].value,ext:o[1].value,value:o[2].value};e.push(l)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return S._logger("%O",0,e),e},this.createUploaderContainer=function(e,t,n){if(S._options.useFileIcons){var r='<img src="/images/'.concat(S._fileType(n),'.png" class="fileThumb" />');z.insertAdjacentHTML("beforeend",r)}var a=document.createElement("div");a.className="newElement",a.dataset.index=parseInt(e),a.style.position="relative",z.appendChild(a);var i=document.createElement("div");i.className="fileActions",a.appendChild(i);var o=document.createElement("a");o.className="fileSee",o.innerHTML=S._options.linkButtonContent,i.appendChild(o);var l=document.createElement("div");if(l.className="fileDelete",l.dataset.delete=parseInt(e),l.innerHTML=S._options.deleteButtonContent,i.append(l),l.addEventListener("click",function(e){S._fileDelete(e,{element:a})}),S._options.useLoadingBars){var s=S._options.loadingBarsClasses;0<s.length&&(s=s.join(" "));var c=document.createElement("div");c.className="loadBar ".concat(s),c.appendChild(document.createElement("div")),a.prepend(c)}var u=document.createElement("input");u.setAttribute("placeholder","nome"),u.className="fileTitle";var d=document.createElement("div");return d.className="fileExt",a.prepend(d),a.prepend(u),function(e,t,n){t instanceof Array||this._logger("addMultipleListeners requires events to be an array");var r=!0,a=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var s=o.value;e.addEventListener(s,n)}}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}}(u,["keypress","keyup","paste"],function(e){e.data={},e.data.element=a,e.data.start=this.selectionStart,e.data.stop=this.selectionEnd,F._fileRename(e)}),u.value=t,d.innerHTML=n,a},this._createResultContainer=function(e){var t=e.index,n=document.createElement("div");n.className=S._options.resultFileContainerClass,n.dataset.index=t,n.insertAdjacentHTML("beforeend","<div>File: ".concat(t,"</div>")),n.insertAdjacentHTML("beforeend",'<input type="text" name="'.concat(S._options.resultPrefix,"[").concat(t,"][").concat(S._options.resultInputNames[0],']" value="').concat(e.name,'" />')),n.insertAdjacentHTML("beforeend",'<input type="text" name="'.concat(S._options.resultPrefix,"[").concat(t,"][").concat(S._options.resultInputNames[1],']" value="').concat(e.type,'" />')),n.insertAdjacentHTML("beforeend",'<textarea name="'.concat(S._options.resultPrefix,"[").concat(t,"][").concat(S._options.resultInputNames[2],']">').concat(e.result,"</textarea>")),n.insertAdjacentHTML("beforeend",'<input type="text" name="'.concat(S._options.resultPrefix,"[").concat(t,"][").concat(S._options.resultInputNames[3],']" value="').concat(e.size,'" />')),M.appendChild(n)},this._filesRead=function(e){var t,n=e.data.DOM,r=!1,a=0;if(t=e.target.files?(S._logger("files array source: file selector (click event)",1),e.target.files):(S._logger("files array source: dropzone (drag & drop event)",1),e.dataTransfer.files),S._logger("%O",0,t),!S._options.allowDuplicates){var i=[],o=[],l=!0,s=!(r=[]),c=void 0;try{for(var u,d=M.children[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;i.push(f.querySelector("input").value)}}catch(e){s=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(s)throw c}}for(a=0;a<t.length;a++)o.push(t[a].name);o.forEach(function(e){i.indexOf(e)<0&&r.push(e)})}E.classList.remove("filesContainerEmpty");var p=function(o,l,s,e,c){var u=Array.from(e.querySelector(".innerFileThumbs").children).filter(function(e){return parseInt(e.dataset.index)===s});u=u[0];var d=S._round(l.size/1e6);o.onloadstart=function(){S._options.onfileloadStart(s),S._logger("START read file: ".concat(s,", size: ").concat(d," MB"),2)},o.onprogress=function(e){if(e.lengthComputable){var t=S._round(e.loaded/e.total*100);S._logger("File ".concat(s," loaded: ").concat(t),3),t<=100&&(u.querySelector(":scope > .loadBar > div").style.width="100%")}},o.onloadend=function(){var e=l.type,t=l.name,n=o.result;if(!n)return!1;"data:"===n.substring(0,n.indexOf(";"))&&0<S._options.defaultMimeType.length&&(n="data:"+S._options.defaultMimeType+n.substring(n.indexOf(";"),n.length)),""===e&&(e=S._options.defaultMimeType),t.indexOf(".")<0&&""!==S._options.defaultFileExt&&(t="".concat(t,".").concat(S._options.defaultFileExt)),S._options.useSourceFileSize||(d=S._round(function(e){for(var t=e.length,n=e.length-1;0<=n;n--){var r=e.charCodeAt(n);127<r&&r<=2047?t++:2047<r&&r<=65535&&(t+=2),56320<=r&&r<=57343&&n--}return t}(n)/1e6));var r={index:s,name:t,type:e,result:n,size:d};S._createResultContainer(r),S._logger("END read file: ".concat(s),4);var a={name:l.name,type:l.type,data:n,size:d};C+=d,N++;var i=F._round(F._options.maxTotalSize-C);T("sizeAvailable",i),T("currentSize",C),T("currentNumberOfFiles",N),T("numberOfUploadedFiles","++"),L(n,c,l.name),S._options.onfileloadEnd(s,a,S._round(C),N)};var t=!0,f=[];S._options.maxFileSize&&d>S._options.maxFileSize&&(t=!1,f.push("maxFileSize")),S._options.maxTotalSize&&C+d>S._options.maxTotalSize&&(t=!1,f.push("maxTotalSize")),S._options.maxNumberOfFiles&&N>=S._options.maxNumberOfFiles&&(t=!1,f.push("maxNumberOfFiles")),t?o.readAsDataURL(l):function(e,t){var n,r=!0,a=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done);r=!0)switch(o.value){case"maxFileSize":n=A.maxSizeExceeded_msg,e._logger("FILE REJECTED: Max file size exceeded - max size: ".concat(e._options.maxFileSize," MB - file size: ").concat(d," MB"));break;case"maxTotalSize":n=A.maxTotalSizeExceeded_msg,e._logger("FILE REJECTED: Max total size exceeded - max size: ".concat(e._options.maxTotalSize," MB - current total size: ").concat(C+d," MB"));break;case"maxNumberOfFiles":n=A.maxNumberOfFilesExceeded_msg,e._logger("FILE REJECTED: Max number of files exceeded - max number: ".concat(e._options.maxNumberOfFiles))}}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}if(u.classList.add("error"),e._options.showErrorOnLoadBar){var s=u.querySelector(":scope > .loadBar");s.innerHTML="",s.insertAdjacentHTML("beforeend",'<div class="errorMsg">'.concat(n,"</div>"))}setTimeout(function(){e._options.useFileIcons&&u.getPreviousSibling("img").remove(),u.remove()},2e3),T("numberOfRejectedFiles","++"),e._options.onfileRejected(f)}(S,f)};function m(e){setTimeout(function(){e.remove()},2e3)}for(a=0;a<t.length;a++){var v=t[a],g=new FileReader;if(r&&r.indexOf(v.name)<0){if(S._options.duplicatesWarning){var b=document.createElement("div");b.className="errorLabel center",b.innerHTML=A.duplicated_msg,z.appendChild(b),m(b)}S._logger("File duplicated: ".concat(v.name," -> skipping..."),2)}else{var h=void 0,y=void 0;y=0<v.name.lastIndexOf(".")?(h=v.name.substring(0,v.name.lastIndexOf(".")),v.name.substring(v.name.lastIndexOf(".")+1,v.name.length)):(h=v.name,S._options.defaultFileExt);var _=S._options.filenameTest(h,y,z);if(!1!==_){void 0!==_&&!0!==_&&(h=_);var x=S.createUploaderContainer(O,h,y);p(g,v,O,n,x),O++}else S._logger("Invalid file name: ".concat(v.name),2)}}},this._options.name&&this._logger("INITIALIZED INSTANCE: "+this._options.name);var n=this._options.HTMLTemplate();t.insertAdjacentHTML("beforeend",n);var r,O=0,M=t.querySelector("."+this._options.resultContainerClass),a=t.querySelector(".fileLoader"),E=t.querySelector(".filesContainer"),z=t.querySelector(".innerFileThumbs"),i=t.querySelector(".dropZone"),A=this._options.langs[this._options.lang],C=0,N=0,c={},o=this._options.labelsClasses;for(var l in this._options.reloadHTML&&(M.innerHTML=this._options.reloadHTML),t.querySelector(".introMsg").innerHTML=A.intro_msg,i.innerHTML=A.dropZone_msg,this._options.debug?(M.insertAdjacentHTML("beforebegin",'<p class="debugMode">Debug mode: on</p>'),M.insertAdjacentHTML("beforebegin",'<div class="debug">Uploaded files: <span class="'.concat(o.numberOfUploadedFiles,'"><span>0</span></span> | Rejected files: <span class="').concat(o.numberOfRejectedFiles,'"><span>0</span></span></div>')),M.insertAdjacentHTML("beforebegin",'<div class="debug">MAX FILE SIZE: '.concat(this._options.maxFileSize," MB</div>")),M.insertAdjacentHTML("beforebegin",'<div class="debug">MAX TOTAL SIZE: '.concat(this._options.maxTotalSize," MB</div>")),M.insertAdjacentHTML("beforebegin",'<div class="debug">MAX NUMBER OF FILES: '.concat(!1===this._options.maxNumberOfFiles?"(none)":this._options.maxNumberOfFiles,"</div>")),M.insertAdjacentHTML("beforebegin",'<div class="debug currentNumberOfFiles">Number of files uploaded: <span>'.concat(N,"</span></div>")),M.insertAdjacentHTML("beforebegin",'<div class="debug sizeAvailable">Size still available: <span>'.concat(this._options.maxTotalSize,"</span> MB</div>"))):M.classList.add("hide"),o)c["".concat(l,"Labels")]=[];var s=this._options.labelsContainers;if(this._options.debug&&(c.sizeAvailableLabels.push(t.querySelector(".".concat(o.sizeAvailable))),c.currentNumberOfFilesLabels.push(t.querySelector(".".concat(o.currentNumberOfFiles))),c.numberOfUploadedFilesLabels.push(t.querySelector(".".concat(o.numberOfUploadedFiles))),c.numberOfRejectedFilesLabels.push(t.querySelector(".".concat(o.numberOfRejectedFiles)))),s){var u=function(e){return document.querySelector(e)};for(var d in o){var f=function(e,t,n){if(e){var r=e.querySelector(".".concat(t[n]));r&&c["".concat(n,"Labels")].push(r)}else this._logger("impossible to find labelContainer '".concat(selector,"'"),1)};if(Array.isArray(s)){var p=!0,m=!1,v=void 0;try{for(var g,b=s[Symbol.iterator]();!(p=(g=b.next()).done);p=!0)f(u(g.value),o,d)}catch(e){m=!0,v=e}finally{try{p||null==b.return||b.return()}finally{if(m)throw v}}}else{var h=u(s);if(h){var y=h.querySelector(".".concat(o[d]));y&&c["".concat(d,"Labels")].push(y)}else this._logger("impossible to find labelContainer '".concat(s,"'"),1)}}}T("maxFileSize",this._options.maxFileSize),T("maxTotalSize",this._options.maxTotalSize),T("maxNumberOfFiles",this._options.maxNumberOfFiles);var _=!0,x=!1,j=void 0;try{for(var q,w=M.querySelectorAll(":scope > .".concat(this._options.resultFileContainerClass)).entries()[Symbol.iterator]();!(_=(q=w.next()).done);_=!0){var I=Z(q.value,2),H=(I[0],I[1]);this._logger("found previously uploaded file: index = ".concat(H.dataset.index),2);var D=H.querySelectorAll(":scope > input"),R=D[0].value,B=D[1].value,U=D[2].value;0<R.lastIndexOf(".")&&(R=R.substr(0,R.lastIndexOf("."))),(r=this.createUploaderContainer(O,R,B)).querySelector(":scope > .loadBar > div").style.width="100%",r.classList.add(this._options.reloadedFilesClass);var k=H.querySelector(":scope textarea").value;L(k,r,R),C+=parseFloat(U),N++,O++}}catch(e){x=!0,j=e}finally{try{_||null==w.return||w.return()}finally{if(x)throw j}}return 0<this._options.reloadArray.length&&this._options.reloadArray.forEach(function(e,t){(r=S.createUploaderContainer(t,e.name,e.ext)).querySelector(":scope > .loadBar > div").style.width="100%",r.classList.add(S._options.reloadedFilesClass),S._logger("found previously uploaded file: index = "+t,2);var n={index:t,name:e.name,type:e.ext,result:e.data,size:e.size};L(e.data,r,e.name),S._createResultContainer(n),C+=parseFloat(e.size),N++,O++}),C=this._round(C),this._logger("current total size: ".concat(C," - current number of files: ").concat(N)),T("sizeAvailable",this._options.maxTotalSize-C),T("currentSize",C),T("currentNumberOfFiles",N),T("numberOfUploadedFiles",N),T("numberOfRejectedFiles","0"),this._options.onload(this._options,C,N),this.handleDragOver=function(e){i.classList.add("highlight"),e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},this.handleDrop=function(e){i.classList.remove("highlight"),e.data={DOM:t},S._filesRead(e)},i.addEventListener("dragleave",function(){i.classList.remove("highlight")}),i.addEventListener("dragover",this.handleDragOver),i.addEventListener("drop",function(){event.stopPropagation(),event.preventDefault(),S.handleDrop(event)}),i.addEventListener("click",function(e){a.click()}),a.addEventListener("change",function(e){e.data={DOM:t},S._filesRead(e),S.value=null}),{fileUploader:F,elementDOM:t}}},{deepmerge:2}],2:[function(e,t,n){var r,a;r=this,a=function(){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s(function(e){return Array.isArray(e)?[]:{}}(e),e,t):e}function o(e,t,n){return e.concat(t).map(function(e){return i(e,n)})}function l(t,n,r){var a={};return r.isMergeableObject(t)&&Object.keys(t).forEach(function(e){a[e]=i(t[e],r)}),Object.keys(n).forEach(function(e){r.isMergeableObject(n[e])&&t[e]?a[e]=function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s}(e,r)(t[e],n[e],r):a[e]=i(n[e],r)}),a}function s(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||a;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):l(e,t,n):i(t,n)}return s.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(e,t){return s(e,t,n)},{})},s},"object"==typeof n&&void 0!==t?t.exports=a():"function"==typeof define&&define.amd?define(a):r.deepmerge=a()},{}]},{},[1]);
//# sourceMappingURL=fileUploader.js.map
