!function o(s,l,r){function d(t,e){if(!l[t]){if(!s[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(p)return p(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=l[t]={exports:{}};s[t][0].call(a.exports,function(e){return d(s[t][1][e]||e)},a,a.exports,o,s,l,r)}return l[t].exports}for(var p="function"==typeof require&&require,e=0;e<r.length;e++)d(r[e]);return d}({1:[function(e,t,i){"use strict";function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var z,r;z=jQuery,r=function(t,e){var g=this;this._defaults={lang:"en",useFileIcons:!0,debug:!1,debugLogStyle:"color: #9900ff",name:void 0,pluginName:"FileUploader",useLoadingBars:!0,loadingBarsClasses:[],reloadedFilesClass:"reloadedElement",resultContainerClass:"result",resultFileContainerClass:"uploadedFile",resultPrefix:"fileUploader",resultInputNames:["title","extension","value","size"],defaultFileExt:"",defaultMimeType:"",fileMaxSize:50,totalMaxSize:1e3,reloadArray:[],reloadHTML:void 0,linkButtonContent:"L",deleteButtonContent:"X",allowDuplicates:!1,duplicatesWarning:!1,HTMLTemplate:function(){return['<p class="introMsg"></p>',"<div>",'    <div class="inputContainer">','        <input class="fileLoader" type="file" multiple />',"    </div>",'    <div class="dropZone"></div>','    <div class="filesContainer filesContainerEmpty">','        <div class="innerFileThumbs"></div>','        <div style="clear:both;"></div>',"    </div>","</div>",'<div class="result"></div>'].join("\n")},onload:function(){},onfileloadStart:function(){},onfileloadEnd:function(){},onfileDelete:function(){},filenameTest:function(){},langs:{en:{intro_msg:"(Add attachments...)",dropZone_msg:"Drop your files here",maxSizeExceeded_msg:"File too large",totalMaxSizeExceeded_msg:"Total size exceeded",duplicated_msg:"File duplicated (skipped)",name_placeHolder:"name"}}},this._options=z.extend(!0,{},this._defaults,e),this.options=function(e){return e?z.extend(!0,this._options,e):this._options},this._round=function(e){return Math.round(100*e)/100},this.get=function(e){var t=this;switch(e){case"currentTotalSize":return t._round(E);case"currentAvailableSize":return t._round(t._options.totalMaxSize-E)}},this._logger=function(e,t,i){if(this._options.debug){if(t)for(var n=0;n<t;n++)e="âž¡ "+e;this._options.name&&(e="["+this._options.pluginName+" - "+this._options.name+"] "+e),i?console.log("%c "+e,this._options.debugLogStyle,i):console.log("%c "+e,this._options.debugLogStyle)}},this._fileType=function(e){var t=e.substring(e.lastIndexOf(".")+1,e.length);return 0<=["pdf","jpg","png"].indexOf(t)?t:"unknown-file"},this._fileDelete=function(e){var t=e.data.element,i=z(e.target).data("delete");i||(i=z(e.target).closest("div[data-delete]").data("delete")),g._options.useFileIcons&&t.prev("img").remove(),t.remove();var n=m.find('input[name="'+g._options.resultPrefix+"["+i+"]["+g._options.resultInputNames[3]+']"]').val();n=g._round(n),E=g._round(E-n);var a=g._options.totalMaxSize-E;a=g._round(a),b.children("span").html(a),m.children('div[data-index="'+i+'"]').remove(),0===z(".innerFileThumbs").children().length&&z(".filesContainer").addClass("filesContainerEmpty"),g._logger("Deleted file N: "+i,2),g._options.onfileDelete(i,E)},this._fileRename=function(e){var t=e.data.element,i=z(e.target),n=t.children(".fileExt").html(),a=i.val(),o=t.data("index"),s=m.find('div[data-index="'+o+'"] input:first'),l=g._options.filenameTest(a,n,C);if(!1===l)return e.preventDefault(),!1;void 0!==l&&!0!==l&&(a=l,i.val(a),0<n.length&&(a=a+"."+n),s.val(a),i[0].setSelectionRange(e.data.start,e.data.stop))},this.getData=function(){var n=[];return this._logger("RECEIVED SAVE COMMAND:",0),z.each(m.children("."+this._options.resultFileContainerClass),function(e,t){var i={title:z(z(t).children("input")[0]).val(),ext:z(z(t).children("input")[1]).val(),value:z(z(t).children("input")[2]).val()};n.push(i)}),this._logger("%O",0,n),n},this._createUploaderContainer=function(e,t,i){if(this._options.useFileIcons){var n=z('<img src="/images/'+this._fileType(i)+'.png" class="fileThumb" />');C.append(n)}var a=z('<div class="newElement" data-index="'+parseInt(e)+'" style="position: relative;"></div');C.append(a);var o=z('<div class="fileActions"></div>');a.append(o);var s=z('<a target="_blank"><div class="fileSee">'+g._options.linkButtonContent+"</div></a>");o.append(s);var l=z('<div data-delete="'+parseInt(e)+'" class="fileDelete">'+g._options.deleteButtonContent+"</div>");if(o.append(l),l.click({element:a},this._fileDelete),this._options.useLoadingBars){var r=g._options.loadingBarsClasses;0<r.length&&(r=r.join(" "));var d=z('<div class="loadBar '+r+'"><div></div></div>');a.prepend(d)}var p=z('<input placeholder="nome" class="fileTitle"></input>'),u=z('<div class="fileExt"></div>');return a.prepend(u),a.prepend(p),p.on("keypress keyup paste",function(e){e.data={},e.data.element=a,e.data.start=this.selectionStart,e.data.stop=this.selectionEnd,g._fileRename(e)}),p.val(t),u.html(i),a},this._createResultContainer=function(e){var t=e.index,i=z('<div data-index="'+t+'" class="'+g._options.resultFileContainerClass+'"></div>');i.append(z("<div>File: "+t+"</div>")),i.append(z("<input/>").attr({type:"text",name:g._options.resultPrefix+"["+t+"]["+g._options.resultInputNames[0]+"]",value:e.name})),i.append(z("<input/>").attr({type:"text",name:g._options.resultPrefix+"["+t+"]["+g._options.resultInputNames[1]+"]",value:e.type})),i.append(z("<input/>").attr({type:"text",name:g._options.resultPrefix+"["+t+"]["+g._options.resultInputNames[2]+"]",value:e.result})),i.append(z("<input/>").attr({type:"text",name:g._options.resultPrefix+"["+t+"]["+g._options.resultInputNames[3]+"]",value:e.size})),m.append(i)},this._filesRead=function(e){var t,i=e.data.DOM,n=!1,a=0;if(t=e.target.files?(this._logger("files array source: file selector (click event)",1),e.target.files):(this._logger("files array source: dropzone (drag & drop event)",1),e.dataTransfer.files),this._logger("%O",0,t),!g._options.allowDuplicates){var o=[],s=[];for(n=[],z.each(m.children(),function(e,t){o.push(z(t).children("input").first().val())}),a=0;a<t.length;a++)s.push(t[a].name);s.forEach(function(e){o.indexOf(e)<0&&n.push(e)})}function l(s,l,r,e){var d=e.find(".innerFileThumbs").children().filter(function(){return z(this).data("index")===r}),p=g._round(l.size/1e6);if(s.onloadstart=function(){g._options.onfileloadStart(r),g._logger("START read file: "+r+", size: "+p+" MB",2)},s.onprogress=function(e){if(e.lengthComputable){var t=g._round(e.loaded/e.total*100);g._logger("File "+r+" loaded: "+t,3),t<=100&&d.children(".loadBar").children("div").animate({width:"100%"},500)}},s.onloadend=function(){var e=l.type,t=l.name,i=s.result;if(!i)return!1;"data:"===i.substring(0,i.indexOf(";"))&&0<g._options.defaultMimeType.length&&(i="data:"+g._options.defaultMimeType+i.substring(i.indexOf(";"),i.length)),""===e&&(e=g._options.defaultMimeType),t.indexOf(".")<0&&""!==g._options.defaultFileExt&&(t=t+"."+g._options.defaultFileExt);var n={index:r,name:t,type:e,result:i,size:p};g._createResultContainer(n),d.children(".fileActions").children("a").attr("href",i),g._logger("END read file: "+r,4);var a=parseInt(z("#debugUploaded").html())+1;z("#debugUploaded").html(a);var o={name:l.name,type:l.type,data:i,size:p};g._options.onfileloadEnd(r,o,g._round(E))},p<=g._options.fileMaxSize&&E+p<=g._options.totalMaxSize){s.readAsDataURL(l),E+=p;var t=g._options.totalMaxSize-E;b.children("span").html(g._round(t))}else{var i=M.totalMaxSizeExceeded_msg;p>g._options.fileMaxSize?(i=M.maxSizeExceeded_msg,g._logger("FILE REJECTED: Max size exceeded - max size: "+g._options.fileMaxSize+" MB - file size: "+p+" MB")):g._logger("FILE REJECTED: Max total size exceeded - max size: "+g._options.totalMaxSizeExceeded_msg+" MB - current total size: "+(E+p)+" MB"),d.addClass("error"),d.children(".loadBar").empty().append('<div class="errorMsg">'+i+"</div>"),setTimeout(function(){d.animate({opacity:0},300,function(){g._options.useFileIcons&&z(this).prev("img").remove(),z(this).remove()})},2e3);var n=parseInt(z("#debugRejected").html())+1;z("#debugRejected").html(n)}}x.removeClass("filesContainerEmpty"),y.html("upload files");var r=z("#innerFileThumbs").children().last().attr("id");function d(e){setTimeout(function(){e.animate({opacity:0},300,function(){z(this).remove()})},2e3)}for(r=void 0!==r?parseInt(r.substring(r.indexOf("-")+1,r.length))+1:0,a=0;a<t.length;a++){var p=t[a],u=new FileReader;if(n&&n.indexOf(p.name)<0){if(g._options.duplicatesWarning){var f=z('<div class="errorLabel center"></div>');f.html(M.duplicated_msg),C.append(f),d(f)}this._logger("File duplicated: "+p.name+" -> skipping...",2)}else{var c,h;h=0<p.name.lastIndexOf(".")?(c=p.name.substring(0,p.name.lastIndexOf(".")),p.name.substring(p.name.lastIndexOf(".")+1,p.name.length)):(c=p.name,this._options.defaultFileExt);var v=this._options.filenameTest(c,h,C);!1!==v?(void 0!==v&&!0!==v&&(c=v),this._createUploaderContainer(_,c,h),l(u,p,_,i),_++):this._logger("Invalid file name: "+p.name,2)}}},this._options.name&&this._logger("INITIALIZED INSTANCE: "+this._options.name);var i=z(this._options.HTMLTemplate());t.append(i);var _=0,m=t.find("."+this._options.resultContainerClass),n=t.find(".fileLoader"),x=t.find(".filesContainer"),y=t.find(".fileNameContainer"),C=t.find(".innerFileThumbs"),a=t.find(".dropZone")[0],M=this._options.langs[this._options.lang];this._options.reloadHTML&&m.html(this._options.reloadHTML),t.find(".introMsg").html(M.intro_msg),z(a).html(M.dropZone_msg),this._options.debug?(z('<p class="debugMode">Debug mode: on</p>').insertBefore(m),z('<div class="debug">Uploaded files: <span id="debugUploaded">0</span> | Rejected files: <span id="debugRejected">0</span></div>').insertBefore(m),z('<div class="debug">Current MAX FILE SIZE: '+this._options.fileMaxSize+" MB</div>").insertBefore(m),z('<div class="debug">Current MAX TOTAL SIZE: '+this._options.totalMaxSize+" MB</div>").insertBefore(m),z('<div class="debug sizeAvailable">Size still available: <span>'+this._options.totalMaxSize+"</span> MB</div>").insertBefore(m)):m.addClass("hide");var s,b=t.find(".sizeAvailable"),E=0;z.each(m.children("."+this._options.resultFileContainerClass),function(e,t){g._logger("found previously uploaded file: index = "+z(t).data("index"),2);var i=z(t).children("input"),n=z(i[0]).val(),a=z(i[1]).val(),o=z(i[3]).val();0<n.lastIndexOf(".")&&(n=n.substr(0,n.lastIndexOf("."))),(s=g._createUploaderContainer(_,n,a)).children(".loadBar").children("div").css({width:"100%"}),s.addClass(g._options.reloadedFilesClass),E+=parseFloat(o),_++}),0<this._options.reloadArray.length&&this._options.reloadArray.forEach(function(e,t){(s=g._createUploaderContainer(t,e.name,e.ext)).children(".loadBar").children("div").css({width:"100%"}),s.addClass(g._options.reloadedFilesClass),g._logger("found previously uploaded file: index = "+t,2);var i={index:t,name:e.name,type:e.ext,result:e.data,size:e.size};g._createResultContainer(i),E+=parseFloat(e.size),_++}),E=g._round(E),this._logger("current total size: "+E),b.children("span").html(this._options.totalMaxSize-E),this._options.onload(this._options,E),a.addEventListener("dragleave",function(){z(a).removeClass("highlight")}),a.addEventListener("dragover",function(e){z(a).addClass("highlight"),e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},!1),a.addEventListener("drop",function(e){!function(e){z(a).removeClass("highlight"),e.stopPropagation(),e.preventDefault(),e.data={DOM:t},g._filesRead(e)}(e)},!1),z(a).click(function(){n.trigger("click")}),n.change({DOM:t},function(e){g._filesRead(e),this.value=null})},z.fn.fileUploader=function(e){var n="string"==typeof e?e:void 0;if(n){var a=[];this.each(function(){var e=z(this).data("fileUploader");a.push(e)});var o=1<arguments.length?Array.prototype.slice.call(arguments,1):void 0,s=[];return this.each(function(e){var t=a[e];if(!t)return console.warn("$.fileUploader not instantiated yet"),console.info(this),void s.push(void 0);if("function"==typeof t[n]){var i=t[n].apply(t,o);s.push(i)}else console.warn("Method '"+n+"' not defined in $.fileUploader")}),1<s.length?s:s[0]}var i="object"===l(e)?e:void 0;return this.each(function(){var e=z(this),t=new r(e,i);e.data("fileUploader",t)})}},{}]},{},[1]);
//# sourceMappingURL=fileUploader.js.map
